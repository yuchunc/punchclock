
-if current_user
  .row
    .col-lg-9
      %ul.nav.nav-tabs#user_functions
        %li.active= link_to "今天 #{Time.now.to_date}", root_path
        %li= link_to "這禮拜", '#'
        %li= link_to "月曆", '#'
        %li= link_to "公司資料", '#'

.row
  .col-lg-9.pane
    = debug @today
    = debug session[:user_id]
    - if @today.present? and !@today.punchin.nil?
      = link_to "上班時間: #{l @today.punchin.to_time}", '#', class: "btn btn-warning btn-large btn-block", disabled: "disabled"
    - else
      = link_to "上工囉!", '#', class: "btn btn-warning btn-large btn-block", id: "punchin"

    - if @today.present?
      - if !@today.punchout.nil?
        = link_to "下班時間: #{l @today.punchout.to_time}", '#', class: "btn btn-info btn-large btn-block", disabled: "disabled"
      - else
        = link_to "下班!YEAH!", '#', class: "btn btn-info btn-large btn-block", id: "punchout"

-# if !@this_week.empty?
  .row
    %table.table.table-striped.table-condensed
      %thead
        %tr
          %th 日期
          %th 上班時間
          %th 下班時間

      %tbody
        - @this_week.each do |tw|
          %tr
            %td= l tw.punchin.to_date
            %td= l tw.punchin.to_time
            %td= l tw.punchout.to_tima

:javascript
  var clock = $('.clock').FlipClock({
    clockFace: 'TwentyFourHourClock'
  });

  $("#punchin").click( function(e) {
    e.preventDefault();
    $.get("punchin", function(resp) {
      location.reload();
    });
  });

  $("#punchout").click( function(e) {
    e.preventDefault();
    $.get("punchout", function(resp) {
      location.reload();
    });
  });
